import{u as I,r as S,j as c}from"./chunk-DQRVZFIR-iiQLzre3.js";import{c as T,u as _}from"./authStore-Bl6YCSMu.js";import{b as F}from"./auth-ByqfQS__.js";import{y as x}from"./index-KeYFdd6Z.js";import{c as L}from"./createLucideIcon-CV70i0aP.js";const H="/assets/logo2-mGD-MQzA.png";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],O=L("shopping-cart",$);function P(t,r){let e;try{e=t()}catch{return}return{getItem:o=>{var a;const m=h=>h===null?null:JSON.parse(h,void 0),l=(a=e.getItem(o))!=null?a:null;return l instanceof Promise?l.then(m):m(l)},setItem:(o,a)=>e.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>e.removeItem(o)}}const b=t=>r=>{try{const e=t(r);return e instanceof Promise?e:{then(s){return b(s)(e)},catch(s){return this}}}catch(e){return{then(s){return this},catch(s){return b(s)(e)}}}},R=(t,r)=>(e,s,o)=>{let a={storage:P(()=>localStorage),partialize:n=>n,version:0,merge:(n,f)=>({...f,...n}),...r},m=!1;const l=new Set,h=new Set;let d=a.storage;if(!d)return t((...n)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),e(...n)},s,o);const g=()=>{const n=a.partialize({...s()});return d.setItem(a.name,{state:n,version:a.version})},k=o.setState;o.setState=(n,f)=>{k(n,f),g()};const v=t((...n)=>{e(...n),g()},s,o);o.getInitialState=()=>v;let p;const C=()=>{var n,f;if(!d)return;m=!1,l.forEach(i=>{var u;return i((u=s())!=null?u:v)});const w=((f=a.onRehydrateStorage)==null?void 0:f.call(a,(n=s())!=null?n:v))||void 0;return b(d.getItem.bind(d))(a.name).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==a.version){if(a.migrate){const u=a.migrate(i.state,i.version);return u instanceof Promise?u.then(j=>[!0,j]):[!0,u]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,i.state];return[!1,void 0]}).then(i=>{var u;const[j,E]=i;if(p=a.merge(E,(u=s())!=null?u:v),e(p,!0),j)return g()}).then(()=>{w==null||w(p,void 0),p=s(),m=!0,h.forEach(i=>i(p))}).catch(i=>{w==null||w(void 0,i)})};return o.persist={setOptions:n=>{a={...a,...n},n.storage&&(d=n.storage)},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>C(),hasHydrated:()=>m,onHydrate:n=>(l.add(n),()=>{l.delete(n)}),onFinishHydration:n=>(h.add(n),()=>{h.delete(n)})},a.skipHydration||C(),p||v},J=R,y="http://localhost:8000",U=async t=>{const r=await fetch(`${y}/api/cart/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"}),e=await r.json();if(!r.ok)throw new Error(e.message||"Failed to create cart");return e},A=async()=>{const t=await fetch(`${y}/api/cart`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to get cart");return r},D=async t=>{const r=await fetch(`${y}/api/cart/update`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"},credentials:"include"}),e=await r.json();if(!r.ok)throw new Error(e.message||"Failed to update cart");return e},G=async t=>{const r=await fetch(`${y}/api/cart/remove/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}),e=await r.json();if(!r.ok)throw new Error(e.message||"Failed to remove cart item");return e},M=async()=>{const t=await fetch(`${y}/api/cart/clear`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to clear cart");return r},Q=async()=>{const t=await fetch(`${y}/api/cart/checkout`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to checkout cart");return r};let N=!1;const q=T()(J((t,r)=>({items:[],loading:!1,fetchCart:async()=>{if(!N){N=!0,t({loading:!0});try{const e=await A();t({items:e.items,loading:!1})}catch(e){console.error(e)}finally{t({loading:!1})}}},addToCart:async e=>{try{await U({productId:e._id,quantity:1}),await r().fetchCart()}catch(s){console.error(s)}},updateQuantity:async(e,s)=>{try{const o=await D({productId:e,quantity:s});t({items:o.items})}catch(o){console.error(o)}},removeItem:async e=>{try{await G(e),t(s=>({items:s.items.filter(o=>o.product._id!==e)}))}catch(s){console.error(s)}},clearCart:async()=>{try{await M(),t({items:[]})}catch(e){console.error(e)}},checkout:async()=>{try{await Q(),t({items:[]})}catch(e){console.error(e)}}}),{name:"cart-storage"})),Y=({cart:t})=>{const{user:r,fetchUser:e}=_(),{fetchCart:s,items:o}=q(),a=I(),[m,l]=S.useState(!1);S.useEffect(()=>{s()},[]);const h=()=>{a("/cart")},d=async()=>{l(!0);try{await F(),await e(),x.dismiss(),x.success("User successfully logged out"),a("/login",{replace:!0})}catch(g){x.dismiss(),x.error(g.message||"Something went wrong")}finally{l(!1)}};return c.jsxs("div",{className:"flex items-center justify-between h-[100px] py-10 bg-[#fefefe] z-50 sticky top-0",children:[c.jsx("div",{className:"pt-5",children:c.jsx("img",{src:H,height:200,width:200,alt:""})}),c.jsxs("div",{className:"flex justify-around pr-20 w-2/3 items-center",children:[c.jsxs("div",{className:"relative w-1/2",children:[c.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"🔍"}),c.jsx("input",{type:"search",className:"border border-gray-400 outline-none h-[40px] rounded-xl pl-10 w-full",placeholder:"Search products, brands and categories"})]}),r?c.jsxs("p",{className:"text-amber-500 ",children:["Hello, ",r.firstName," "]}):c.jsxs("button",{className:"hover:text-amber-500",children:[" ",c.jsx("a",{href:"/login",children:"Login"})," "]}),r?r.role==="admin"?c.jsx("button",{className:"hover:text-amber-500",children:c.jsx("a",{href:"/dashboard",children:"Dashboard"})}):c.jsx("p",{className:"cursor-pointer hover:text-amber-500",onClick:d,children:"Logout"}):c.jsx("p",{className:"cursor-pointer hover:text-amber-500",children:"Help"}),c.jsxs("div",{className:"cursor-pointer relative flex gap-3 hover:text-amber-500",onClick:h,children:[c.jsxs("span",{children:[c.jsx(O,{}),o.length>0&&c.jsx("span",{className:"bg-red-500 rounded-full text-[8px] px-1 absolute text-white -top-1 left-5",children:o.length})]}),c.jsx("p",{children:"Cart"})]})]})]})};export{Y as N,O as S,U as a,q as u};
